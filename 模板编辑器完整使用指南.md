# 📝 模板编辑器完整使用指南

## 🎯 功能概述

模板编辑器是一个**Word文档标签插入工具**,允许您：
- 上传现有的Word教案模板
- 可视化查看文档结构（段落、表格）
- 在任意位置插入智能标签
- 下载带标签的模板用于自动生成

---

## 🚀 快速开始

### 步骤1: 访问编辑器

**方式1**: 从主页进入
- 在欢迎页面点击"智能标签编辑器"卡片
- 或点击步骤1中的"在线编辑"链接

**方式2**: 直接访问
- URL: `http://localhost:5000/template-editor`

### 步骤2: 上传Word模板

1. 点击"选择文件"按钮
2. 或直接拖拽Word文档到上传区域
3. 支持格式：`.docx`

**提示**:
- 可以上传空白模板
- 也可以上传已有内容的教案模板
- 系统会自动分析文档结构

### 步骤3: 选择插入位置

文档上传后,左侧会显示文档结构:

**段落结构**:
```
📝 段落
  ├─ 段落 1: "教案标题..."
  ├─ 段落 2: "课程名称..."
  └─ ...
```

**表格结构**:
```
📊 表格
  └─ 表格 1 (5行 × 3列)
      ├─ 单元格 [0,0]: "教学环节"
      ├─ 单元格 [0,1]: "教师活动"
      └─ ...
```

**操作**:
- 点击任意段落或单元格
- 被选中的项会高亮显示

### 步骤4: 插入标签

1. 选中位置后，中间面板会显示所有可用标签
2. 标签按类别分组（点击类别可展开/折叠）
3. 点击任意标签,系统会：
   - 在选中位置插入标签 `{{标签名}}`
   - 标签显示为绿色（便于识别）
   - 右侧显示插入记录

### 步骤5: 下载模板

1. 插入所需标签后
2. 点击顶部"下载模板"按钮
3. 获得文件：`tagged_您的文件名.docx`

### 步骤6: 使用模板生成教案

1. 返回主页
2. 上传带标签的模板
3. 输入课程需求
4. 系统自动检测标签并使用智能填充模式

---

## 🏷️ 标签分类详解

### 1. 基本信息 (7个)

| 标签 | 用途 | 插入位置建议 |
|------|------|------------|
| `{{course_name}}` | 课程名称 | 封面/标题 |
| `{{teacher_name}}` | 授课教师 | 封面 |
| `{{class_name}}` | 授课班级 | 封面 |
| `{{lesson_number}}` | 课次 | 封面 |
| `{{lesson_title}}` | 课题 | 标题 |
| `{{teaching_hours}}` | 学时 | 封面 |
| `{{chapter_section}}` | 授课章节 | 封面/标题 |

### 2. 教学目标 (4个)

- `{{ideological_goals}}` - 思政育人目标
- `{{knowledge_goals}}` - 知识目标
- `{{ability_goals}}` - 能力目标
- `{{ideological_elements}}` - 思政元素

### 3. 教学重难点 (4个)

- `{{teaching_focus}}` - 教学重点
- `{{focus_solutions}}` - 重点解决措施
- `{{teaching_difficulty}}` - 教学难点
- `{{difficulty_solutions}}` - 难点解决措施

### 4. 教学方法 (3个)

- `{{teaching_methods}}` - 教法
- `{{learning_methods}}` - 学法
- `{{teaching_resources}}` - 教学资源

### 5. 教学过程环节 (共40个标签)

**10个教学环节**,每个环节4个维度:
- `xxx_content` - 教学内容
- `xxx_teacher` - 教师活动
- `xxx_student` - 学生活动
- `xxx_intention` - 设计意图

**环节列表**:
1. 课前预习 (`preview_xxx`)
2. 自主学习 (`self_learning_xxx`)
3. 新课导入 (`introduction_xxx`)
4. 预习反馈 (`feedback_xxx`)
5. 新课讲授 (`teaching_xxx`)
6. 实践环节 (`practice_xxx`)
7. 展示环节 (`presentation_xxx`)
8. 评价环节 (`evaluation_xxx`)
9. 课后作业 (`homework_xxx`)
10. 阅读延伸 (`extension_xxx`)

### 6. 教学反思 (2个)

- `{{reflection_effects}}` - 目标效果
- `{{reflection_improvements}}` - 反思改进

---

## 💡 最佳实践

### 表格式模板推荐布局

```
┌─────────────────────────────────────────┐
│ 课程名称: {{course_name}}               │
│ 授课教师: {{teacher_name}}              │
│ 授课班级: {{class_name}}                │
│ 课次: {{lesson_number}}                 │
├─────────────────────────────────────────┤
│ 一、教学目标                            │
│   思政育人目标: {{ideological_goals}}   │
│   知识目标: {{knowledge_goals}}         │
│   能力目标: {{ability_goals}}           │
├─────────────────────────────────────────┤
│ 二、教学重难点                          │
│   教学重点: {{teaching_focus}}          │
│   解决措施: {{focus_solutions}}         │
│   教学难点: {{teaching_difficulty}}     │
│   解决措施: {{difficulty_solutions}}    │
├─────────────────────────────────────────┤
│ 三、教学过程                            │
│ ┌─────┬──────────┬──────────┬─────┐  │
│ │环节 │教学内容  │教师活动  │学生活动│  │
│ ├─────┼──────────┼──────────┼─────┤  │
│ │课前 │{{preview │{{preview │{{pre││  │
│ │预习 │_content}}│_teacher}}│view_││  │
│ │     │          │          │stud-││  │
│ │     │          │          │ent}}│  │
│ ├─────┼──────────┼──────────┼─────┤  │
│ │新课 │{{intro-  │{{intro-  │{{in-││  │
│ │导入 │duction_  │duction_  │tro- ││  │
│ │     │content}} │teacher}} │duc- ││  │
│ │     │          │          │tion_││  │
│ │     │          │          │stud-││  │
│ │     │          │          │ent}}│  │
│ └─────┴──────────┴──────────┴─────┘  │
└─────────────────────────────────────────┘
```

### 插入顺序建议

1. **先插入基本信息标签** (封面部分)
2. **再插入目标和重难点** (主体前部)
3. **最后插入教学过程标签** (主体部分)
4. **补充反思标签** (结尾)

### 标签数量建议

- **最少**: 10-15个核心标签（基本信息+目标+重难点）
- **适中**: 20-30个标签（加上部分教学环节）
- **完整**: 40-50个标签（覆盖所有教学环节）

---

## ❓ 常见问题

### Q1: 可以在一个位置插入多个标签吗?

A: 可以！重复操作即可：
1. 选择位置 → 插入标签A
2. 再次选择同一位置 → 插入标签B
3. 结果: "原内容 {{标签A}} {{标签B}}"

### Q2: 标签会覆盖原有内容吗?

A: 不会！标签总是**追加**到原内容后面。
- 段落: 追加到段落末尾
- 表格: 追加到单元格内容末尾

### Q3: 如何删除已插入的标签?

A: 下载模板后,用Word打开,手动删除标签即可。

### Q4: 标签大小写敏感吗?

A: 是的！必须完全匹配：
- ✅ `{{course_name}}`
- ❌ `{{Course_Name}}`
- ❌ `{{coursename}}`

### Q5: 可以自定义标签吗?

A: 目前系统支持60个预置标签。如需新标签,请联系管理员添加到 `WordTagInserter` 类中。

### Q6: 编辑器支持多人协作吗?

A: 不支持。每次上传都是独立的会话。建议：
1. 一人编辑完成
2. 下载模板
3. 分享给其他人使用

### Q7: 会话会保存多久?

A: 临时文件保存在 `uploads/edit_<session_id>/` 目录。建议编辑完立即下载。

---

## 🎓 示例教案模板

### 模板A: 简洁版

```
课程名称: {{course_name}}
授课教师: {{teacher_name}}
授课班级: {{class_name}}
第 {{lesson_number}} 次课

一、课题
{{lesson_title}}

二、教学目标
{{knowledge_goals}}

三、教学重点
{{teaching_focus}}

四、教学过程
{{teaching_content}}
```

### 模板B: 标准版 (推荐)

详见上文"表格式模板推荐布局"

### 模板C: 完整版

包含所有60个标签的完整教案模板,适合详细教学设计。

---

## 🔧 技术实现

### 后端API

- `POST /api/template-editor/upload` - 上传并解析
- `GET /api/template-editor/tags` - 获取标签列表
- `POST /api/template-editor/insert-tag` - 插入标签
- `GET /api/template-editor/download/<session_id>/<filename>` - 下载

### 核心技术

- **python-docx**: Word文档解析和修改
- **WordTagInserter**: 标签管理和插入
- **Session管理**: 临时文件存储

---

## 📞 获取帮助

- 📖 查看 `完整标签列表.md` 了解所有标签
- 🔍 使用编辑器内的搜索功能查找标签
- ⚙️ 查看控制台输出了解详细信息

---

**祝您编辑愉快！** ✨

现在您可以轻松为您的Word模板添加智能标签,享受自动化教案生成的便利！

