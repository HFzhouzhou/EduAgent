# 📝 模板编辑器使用指南

## 🎯 功能概述

模板编辑器是一个**在线可视化工具**,允许您直接在网页中创建和编辑带有智能标签的Word教案模板。

### ✨ 核心功能

- **可视化编辑**: 所见即所得的富文本编辑器
- **智能标签**: 60+个预置标签,点击即可插入
- **分类管理**: 标签按功能分类,方便查找
- **实时预览**: 右侧实时显示模板效果
- **标签统计**: 自动统计使用的标签数量
- **保存下载**: 支持保存到浏览器和下载为HTML

---

## 🚀 快速开始

### 步骤1: 访问编辑器

1. 启动系统: `python web_main.py`
2. 打开浏览器访问: `http://localhost:5000`
3. 点击顶部导航栏的 **📝 编辑图标** (模板编辑器)

### 步骤2: 编辑模板

编辑器会自动加载一个默认模板,包含常用的标签布局。

**您可以**:
- ✏️ 直接编辑文字
- 🎨 使用工具栏格式化文本(加粗、标题、列表等)
- 🏷️ 点击左侧标签插入到光标位置
- 📋 使用"插入表格"创建表格布局
- 🗑️ 清空内容重新开始

### 步骤3: 插入标签

**方法1: 点击标签**
1. 在右侧文档中将光标定位到要插入的位置
2. 点击左侧标签面板中的任意标签
3. 标签会自动插入到光标位置

**方法2: 手动输入**
- 直接输入 `{{标签名}}`,例如 `{{course_name}}`

**提示**:
- 标签会以绿色高亮显示
- 可以使用搜索框快速查找标签
- 点击分类标题可展开/折叠该分类

### 步骤4: 保存和导出

**保存到浏览器**:
- 点击顶部 **💾 保存** 按钮
- 模板会保存到浏览器的localStorage
- 下次访问时会自动加载

**下载为文件**:
- 点击顶部 **📥 下载** 按钮
- 下载HTML格式的模板
- 可以用Word打开并另存为.docx

---

## 🏷️ 标签分类说明

### 📌 基本信息 (7个)

| 标签 | 说明 | 示例 |
|------|------|------|
| `{{course_name}}` | 课程名称 | 数据结构 |
| `{{teacher_name}}` | 授课教师 | 张老师 |
| `{{class_name}}` | 授课班级 | 计算机2021级1班 |
| `{{lesson_number}}` | 课次 | 1 |
| `{{lesson_title}}` | 课题 | 数据结构概述 |
| `{{teaching_hours}}` | 学时 | 2 |
| `{{chapter_section}}` | 授课章节 | 第一章 |

### 🎯 教学目标 (4个)

- `{{ideological_goals}}` - 思政育人目标
- `{{knowledge_goals}}` - 知识目标
- `{{ability_goals}}` - 能力目标
- `{{ideological_elements}}` - 思政元素

### ⚡ 教学重难点 (4个)

- `{{teaching_focus}}` - 教学重点
- `{{focus_solutions}}` - 重点解决措施
- `{{teaching_difficulty}}` - 教学难点
- `{{difficulty_solutions}}` - 难点解决措施

### 🔧 教学方法 (3个)

- `{{teaching_methods}}` - 教法
- `{{learning_methods}}` - 学法
- `{{teaching_resources}}` - 教学资源

### 📚 教学过程环节 (每个环节4个标签)

每个教学环节包含:
- `xxx_content` - 教学内容
- `xxx_teacher` - 教师活动
- `xxx_student` - 学生活动
- `xxx_intention` - 设计意图

**支持的环节**:
1. **课前预习** (`preview_xxx`)
2. **自主学习** (`self_learning_xxx`)
3. **新课导入** (`introduction_xxx`)
4. **预习反馈** (`feedback_xxx`)
5. **新课讲授** (`teaching_xxx`)
6. **实践环节** (`practice_xxx`)
7. **展示环节** (`presentation_xxx`)
8. **评价环节** (`evaluation_xxx`)
9. **课后作业** (`homework_xxx`)
10. **阅读延伸** (`extension_xxx`)

**示例**:
```
课前预习:
教学内容: {{preview_content}}
教师活动: {{preview_teacher}}
学生活动: {{preview_student}}
设计意图: {{preview_intention}}
```

### 💭 教学反思 (2个)

- `{{reflection_effects}}` - 目标效果
- `{{reflection_improvements}}` - 反思改进

---

## 📊 编辑器功能详解

### 富文本编辑

**文本格式**:
- 标题 (H1, H2, H3)
- 加粗、斜体、下划线、删除线
- 文字颜色和背景色
- 对齐方式(左、中、右)

**列表**:
- 有序列表 (1. 2. 3.)
- 无序列表 (• • •)

**插入元素**:
- 引用块
- 代码块
- 链接
- 图片

### 快捷操作

**📊 插入表格**:
- 点击工具栏"表格"按钮
- 自动插入2x2表格模板
- 在表格单元格中可以插入标签

**📝 插入列表**:
- 自动插入3项有序列表
- 每项包含一个标签占位符

**🗑️ 清空内容**:
- 一键清空所有内容
- 确认后操作不可恢复

### 实时统计

右侧预览面板显示:
- **字数统计**: 当前文档字数
- **已使用标签**: 插入的标签总数
- **识别的标签**: 系统支持的标签数
- **未识别的标签**: 拼写错误或不支持的标签

---

## 💡 最佳实践

### 1. 模板设计建议

**结构清晰**:
```markdown
# 教案标题

## 一、基本信息
课程名称: {{course_name}}
...

## 二、教学目标
### 思政育人目标
{{ideological_goals}}

### 知识目标
{{knowledge_goals}}
...
```

**表格布局**:
```html
<table>
    <tr>
        <td>教学内容</td>
        <td>{{preview_content}}</td>
    </tr>
    <tr>
        <td>教师活动</td>
        <td>{{preview_teacher}}</td>
    </tr>
</table>
```

**列表形式**:
```markdown
教学重点:
1. {{teaching_focus}}

解决措施:
1. {{focus_solutions}}
```

### 2. 标签使用技巧

**正确写法**:
✅ `{{course_name}}`
✅ `{{teaching_focus}}`
✅ `{{preview_content}}`

**错误写法**:
❌ `{course_name}` (缺少一对大括号)
❌ `{{ course_name }}` (标签内有空格)
❌ `{{courseName}}` (驼峰命名,应该用下划线)

### 3. 格式建议

- 使用**二级标题**(`##`)区分主要部分
- 使用**三级标题**(`###`)区分子部分
- 重要信息用**加粗**标记
- 合理使用空行提高可读性

---

## 🔄 完整工作流程

```
┌─────────────────────┐
│ 1. 访问模板编辑器   │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 2. 设计模板布局     │
│   - 添加标题        │
│   - 插入表格/列表   │
│   - 设置格式        │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 3. 插入智能标签     │
│   - 点击左侧标签    │
│   - 或手动输入      │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 4. 预览和调整       │
│   - 查看右侧预览    │
│   - 检查标签统计    │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 5. 保存模板         │
│   - 保存到浏览器    │
│   - 或下载为文件    │
└──────────┬──────────┘
           │
           ▼
┌─────────────────────┐
│ 6. 使用模板生成教案 │
│   - 返回主页        │
│   - 上传模板        │
│   - 输入课程需求    │
│   - 自动生成        │
└─────────────────────┘
```

---

## ❓ 常见问题

### Q1: 我的模板能导出为真正的Word文档吗?

A: 目前编辑器导出的是HTML格式,但您可以:
1. 使用Microsoft Word打开HTML文件
2. 在Word中另存为`.docx`格式
3. 所有格式和标签都会保留

### Q2: 为什么有些标签显示为"未识别"?

A: 可能原因:
- 标签名拼写错误
- 标签内有多余空格
- 使用了不支持的标签名

请参考左侧标签面板确认正确的标签名。

### Q3: 如何导入已有的Word模板?

A: 目前支持导入HTML格式的模板:
1. 将Word另存为"网页(*.html)"
2. 点击"导入"按钮选择HTML文件
3. 系统会自动提取内容到编辑器

### Q4: 模板保存在哪里?

A: 点击"保存"按钮后,模板保存在**浏览器的本地存储**中:
- 优点: 快速,无需服务器
- 缺点: 清除浏览器数据会丢失
- 建议: 定期使用"下载"按钮备份

### Q5: 可以在表格中使用标签吗?

A: 完全可以!标签可以在任何位置使用:
- 表格单元格中
- 列表项中
- 引用块中
- 标题中

---

## 🎨 高级技巧

### 1. 创建复杂表格

```html
<table style="width:100%; border-collapse:collapse;">
    <thead>
        <tr style="background:#f0f0f0;">
            <th style="border:1px solid #ddd; padding:8px;">环节</th>
            <th style="border:1px solid #ddd; padding:8px;">内容</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="border:1px solid #ddd; padding:8px;">课前预习</td>
            <td style="border:1px solid #ddd; padding:8px;">{{preview_content}}</td>
        </tr>
    </tbody>
</table>
```

### 2. 使用条件标签(Jinja2语法)

```jinja2
{% if homework_content %}
课后作业: {{homework_content}}
{% endif %}
```

### 3. 循环列表

```jinja2
教学目标:
{% for objective in objectives %}
- {{objective}}
{% endfor %}
```

---

## 🎓 示例模板

### 简洁版模板

```markdown
# {{lesson_title}}

**课程**: {{course_name}}
**教师**: {{teacher_name}}
**学时**: {{teaching_hours}}

## 教学目标
{{knowledge_goals}}

## 教学重点
{{teaching_focus}}

## 教学过程
{{teaching_content}}
```

### 完整版模板

(已预置在编辑器中,包含所有分类和标签)

---

## 📞 获取帮助

- 💬 悬停在标签上可查看说明
- 📖 查看 `完整标签列表.md`
- 🔍 使用搜索框快速查找标签
- ⚙️ 点击右上角图标查看编辑器设置

---

**祝您使用愉快!** ✨

