# 🎯 双模式教案生成系统使用说明

## 📋 概述

本系统提供两种教案生成模式，满足不同用户的需求：
- **⚡ 快速生成模式**（免费）：适合大多数用户，快速生成教案
- **🏷️ 智能标签模式**（VIP）：适合高级用户，精确控制内容结构

---

## 🚀 快速开始

### 步骤1: 上传模板

**方式A：拖拽上传**
```
将教案模板文件（.doc/.docx）拖拽到页面任意位置
```

**方式B：点击上传**
```
点击顶部导航栏的文档图标 📄
选择本地Word模板文件
```

### 步骤2: 选择模式

上传成功后，系统会显示两个选项卡：

```
┌─────────────────────────────────────────┐
│     🌟 选择您的方式                      │
│   系统提供两种模式，请选择适合您的方式   │
└─────────────────────────────────────────┘

┌────────────────┐  ┌────────────────┐
│   ⚡ 快速生成   │  │  🏷️ 智能标签   │
│                │  │   编辑 [VIP]   │
│ 系统自动识别    │  │ 可视化编辑模板 │
│ 立即开始生成    │  │ 精确插入60+标签│
│ ✓ 免费         │  │ ★ 高级功能     │
└────────────────┘  └────────────────┘
```

---

## ⚡ 模式1：快速生成（推荐）

### 适用场景
- ✅ 快速生成教案，不需要精确控制格式
- ✅ 使用标准Word模板
- ✅ 对AI生成内容信任度高
- ✅ 追求效率，节省时间

### 使用步骤

**1. 上传模板**
   - 拖拽或点击上传Word模板
   - 支持 `.doc` 和 `.docx` 格式

**2. 选择"快速生成"**
   - 点击左侧的 ⚡ 快速生成卡片

**3. 输入课程需求**
   系统会提示您输入课程信息，例如：

   ```
   我要生成《数据结构》课程的教案，16课时，计算机专业
   ```

   或者：

   ```
   帮我做一个操作系统课程的教案，32学时，3学分，面向大二学生
   ```

**4. 自动生成**
   系统将自动完成以下步骤：
   - 🔄 步骤1/3：解析模板结构
   - 🔄 步骤2/3：生成课程大纲
   - 🔄 步骤3/3：批量生成教案

**5. 导出结果**
   - 点击顶部"导出"按钮
   - 选择文件名
   - 下载Word文档

### 工作原理

```
用户输入 → AI识别模板 → AI生成大纲 → AI生成教案 → 导出Word
```

系统使用视觉语言模型（VLM）自动识别模板结构，无需手动标注。

### 优势
- ⚡ **快速**：3-5分钟完成
- 💰 **免费**：无额外费用
- 🎯 **准确**：AI智能识别模板
- 🔄 **灵活**：支持各种模板格式

---

## 🏷️ 模式2：智能标签编辑（VIP）

### 适用场景
- ✅ 需要精确控制教案内容结构
- ✅ 模板格式复杂（多层表格、嵌套结构）
- ✅ 重复使用同一模板生成多份教案
- ✅ 对格式一致性要求极高

### 使用步骤

**1. 上传模板**
   - 拖拽或点击上传Word模板

**2. 选择"智能标签编辑"**
   - 点击右侧的 🏷️ 智能标签编辑卡片
   - 系统将在2秒后跳转到编辑器

**3. 可视化编辑**
   进入编辑器后，您会看到三个面板：

   ```
   ┌────────┬────────┬────────┐
   │ 文档   │ 标签   │ 历史   │
   │ 结构   │ 选择   │ 记录   │
   │        │        │        │
   │ 📝段落1│ 基本信息│ ✓插入1 │
   │ 📝段落2│ 教学目标│ ✓插入2 │
   │ 📊表格1│ 教学重点│ ✓插入3 │
   └────────┴────────┴────────┘
   ```

**4. 插入标签**
   - **左侧**：点击要插入标签的位置（段落或单元格）
   - **中间**：选择要插入的标签（60+标签可选）
   - **右侧**：查看插入历史

**5. 下载模板**
   - 点击顶部"下载模板"按钮
   - 获得带标签的模板：`tagged_xxx.docx`

**6. 使用模板生成**
   - 返回主页
   - 上传带标签的模板
   - 系统自动识别为"标签模式"
   - 输入课程需求，开始生成

### 工作原理

```
上传模板 → 可视化编辑 → 插入{{标签}} → 下载模板 → 上传生成
```

系统使用 `docxtpl` 库实现精确的模板填充，确保格式完全一致。

### 标签分类

| 类别 | 标签数 | 示例 |
|------|--------|------|
| **基本信息** | 7 | `{{course_name}}`, `{{teacher_name}}` |
| **教学目标** | 4 | `{{knowledge_goals}}`, `{{ability_goals}}` |
| **教学重难点** | 4 | `{{teaching_focus}}`, `{{teaching_difficulty}}` |
| **教学方法** | 3 | `{{teaching_methods}}`, `{{learning_methods}}` |
| **教学过程** | 40 | `{{preview_content}}`, `{{teaching_teacher}}` |
| **教学反思** | 2 | `{{reflection_effects}}`, `{{reflection_improvements}}` |

完整标签列表请参考：`完整标签列表.md`

### 优势
- 🎯 **精确**：100%控制内容位置
- 🔄 **可重复**：一次编辑，多次使用
- 📋 **标准化**：确保格式完全一致
- 🏆 **专业**：支持复杂模板结构

---

## 🆚 两种模式对比

| 特性 | 快速生成 ⚡ | 智能标签 🏷️ |
|------|------------|-------------|
| **费用** | 免费 | VIP |
| **速度** | 3-5分钟 | 首次10分钟，后续3分钟 |
| **精确度** | 85-95% | 100% |
| **学习成本** | 无 | 低（5分钟上手） |
| **适用模板** | 标准模板 | 所有模板 |
| **重复使用** | 每次重新识别 | 一次标注，永久使用 |
| **格式一致性** | 较好 | 完美 |
| **推荐场景** | 日常使用 | 批量生成、高要求 |

---

## 💡 使用建议

### 首次使用
👉 **推荐：快速生成模式**
- 先体验快速生成
- 了解系统能力
- 评估生成质量

### 重复使用同一模板
👉 **推荐：智能标签模式**
- 一次标注，多次使用
- 批量生成时效率更高
- 格式完全统一

### 模板格式复杂
👉 **推荐：智能标签模式**
- 复杂表格嵌套
- 特殊格式要求
- 多种内容类型混合

### 临时使用
👉 **推荐：快速生成模式**
- 一次性生成
- 无需重复使用
- 追求速度

---

## 📚 相关文档

- 📖 **完整标签列表**：`完整标签列表.md`
- 🎓 **模板编辑器指南**：`模板编辑器完整使用指南.md`
- 🔧 **智能模板系统**：`智能模板系统使用说明.md`
- 📘 **项目总文档**：`README.md`

---

## ❓ 常见问题

### Q1: 两种模式可以切换吗？
**A:** 可以！上传模板后随时选择。如果选择了快速生成，下次可以重新上传选择标签模式。

### Q2: 已有带标签的模板，还需要编辑吗？
**A:** 不需要！系统会自动识别标签，直接进入"标签模式"生成。

### Q3: 快速生成的质量如何？
**A:** 使用 qwen-vl-plus 视觉模型，识别准确率85-95%，足够日常使用。

### Q4: 标签模式有数量限制吗？
**A:** 当前支持60个标签，覆盖99%的教案需求。如需自定义，请联系管理员。

### Q5: 可以先快速生成，再用标签优化吗？
**A:** 可以！建议流程：
1. 快速生成查看效果
2. 如果不满意，编辑模板添加标签
3. 重新生成获得更精确的结果

### Q6: VIP功能如何开通？
**A:** 当前标签编辑功能完全免费开放，"VIP"仅为功能定位标识。

---

## 🎯 最佳实践

### 实践1：模板准备
```
✅ DO:
  - 使用Word原生格式（.docx）
  - 保持模板结构清晰
  - 预留足够的内容空间

❌ DON'T:
  - 使用PDF或图片格式
  - 过度复杂的嵌套结构
  - 文本框、浮动元素过多
```

### 实践2：标签使用
```
✅ DO:
  - 按照建议的分类插入标签
  - 在合适的位置插入（段落/单元格）
  - 使用完整的标签语法 {{tag_name}}

❌ DON'T:
  - 自己编写标签名称
  - 遗漏大括号
  - 在不支持的位置插入（如图片中）
```

### 实践3：课程需求描述
```
✅ 好的描述：
  "我要生成《数据结构》课程的教案，16课时，计算机专业，面向大二学生，
   包含链表、栈、队列、树、图等内容，注重实践操作"

❌ 不好的描述：
  "生成教案"
  "数据结构"
```

---

## 🌟 开始使用

现在就启动系统，体验双模式的强大功能：

```bash
python web_main.py
```

访问：**http://localhost:5000**

---

**祝您使用愉快！** 🎉

如有问题，请查阅详细文档或联系技术支持。

