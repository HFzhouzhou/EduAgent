# 模板编辑器实现说明

## ✅ 已完成

### 1. 删除Gradio相关代码
- ✅ 删除 `interface/gradio_app.py`
- ✅ 删除 `gradio_README.md`
- ✅ 删除 `main.py`
- ✅ 从 `requirements.txt` 移除 gradio 依赖

### 2. 创建新的工具类
- ✅ `utils/word_tag_inserter.py` - Word标签插入工具
  - 提取Word文档结构
  - 在指定位置插入标签
  - 按分类管理60+标签

### 3. 新版模板编辑器页面
- ✅ `templates/template_editor_v2.html` - 新UI设计
  - 步骤1: 上传Word模板
  - 步骤2: 选择位置插入标签
  - 步骤3: 下载带标签的模板

## 🔄 需要继续完成

### 1. Flask API路由
需要添加以下API:
- `POST /api/template/upload` - 上传Word文档
- `POST /api/template/structure` - 获取文档结构
- `POST /api/template/insert-tag` - 插入标签
- `GET /api/template/download/<session_id>` - 下载编辑后的文档

### 2. 前端JavaScript
- `static/js/template_editor_v2.js` - 处理上传、显示结构、插入标签

### 3. CSS样式
- 更新 `static/css/template_editor.css` 支持新布局

### 4. 主页入口
- 在主页添加"编辑模板"按钮

## 📝 工作流程

```
1. 用户在主页点击"编辑模板"
   ↓
2. 跳转到模板编辑器页面
   ↓
3. 用户上传Word文档 (.docx)
   ↓
4. 系统分析文档结构（段落+表格）
   ↓
5. 显示文档结构树
   ├─ 段落列表
   └─ 表格列表（行列）
   ↓
6. 用户选择要插入标签的位置
   ├─ 点击段落
   └─ 点击表格单元格
   ↓
7. 用户从标签面板选择标签
   ↓
8. 系统在选中位置插入标签 {{标签名}}
   ↓
9. 重复6-8，插入多个标签
   ↓
10. 点击"下载模板"
    ↓
11. 获得带标签的Word文档
    ↓
12. 在主页上传此模板，即可使用标签模式生成教案
```

## 🎯 下一步操作

运行以下命令完成剩余工作:

\`\`\`bash
# 由于代码较长，建议分步完成:
# 1. 先实现Flask API
# 2. 再实现前端JavaScript
# 3. 更新CSS样式
# 4. 添加主页入口
# 5. 测试完整流程
\`\`\`

所有代码已经准备好框架，只需填充具体实现。

